/*
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘                  âš ï¸ â˜ ï¸  HERE BE DRAGONS  â˜ ï¸ âš ï¸                        â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘   â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸â¸¸   â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘            ğŸ”¥ ABANDON ALL HOPE, YE WHO ENTER HERE ğŸ”¥                 â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â–‘â–‘
 * â–‘â–‘   â”‚                                                             â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  Greetings, foolish mortal who stumbles into this abyss.   â”‚   â–‘â–‘
 * â–‘â–‘   â”‚                                                             â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  What lies before you is not codeâ€”it is a CURSE.           â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  A labyrinth of logic so twisted, so arcane, that it       â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  defies comprehension itself.                               â”‚   â–‘â–‘
 * â–‘â–‘   â”‚                                                             â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  This monstrosity is held together by:                      â”‚   â–‘â–‘
 * â–‘â–‘   â”‚    â€¢ Duct tape (metaphorical and spiritual)                â”‚   â–‘â–‘
 * â–‘â–‘   â”‚    â€¢ Prayers whispered at 3 AM                             â”‚   â–‘â–‘
 * â–‘â–‘   â”‚    â€¢ Stack Overflow answers from 2009                      â”‚   â–‘â–‘
 * â–‘â–‘   â”‚    â€¢ Pure, unfiltered desperation                          â”‚   â–‘â–‘
 * â–‘â–‘   â”‚    â€¢ The tears of junior developers                        â”‚   â–‘â–‘
 * â–‘â–‘   â”‚                                                             â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  Once, two beings understood this code:                     â”‚   â–‘â–‘
 * â–‘â–‘   â”‚             âš¡ God and Me âš¡                                 â”‚   â–‘â–‘
 * â–‘â–‘   â”‚                                                             â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  Now... I have forgotten.                                   â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  Only God remains.                                          â”‚   â–‘â–‘
 * â–‘â–‘   â”‚  And I'm not sure He's still watching.                      â”‚   â–‘â–‘
 * â–‘â–‘   â”‚                                                             â”‚   â–‘â–‘
 * â–‘â–‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘               âš”ï¸  YOUR OPTIONS, BRAVE WARRIOR:  âš”ï¸                   â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘         1. Turn back now. Close this file. Walk away.                â–‘â–‘
 * â–‘â–‘         2. Proceed at your own peril and join the fallen.            â–‘â–‘
 * â–‘â–‘         3. Rewrite from scratch (recommended).                       â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘   If you choose Option 2, know this:                                 â–‘â–‘
 * â–‘â–‘   â€¢ Touching ANYTHING may cause catastrophic failure                 â–‘â–‘
 * â–‘â–‘   â€¢ The tests pass by ACCIDENT, not design                           â–‘â–‘
 * â–‘â–‘   â€¢ Production stability is a MYTH we tell ourselves                 â–‘â–‘
 * â–‘â–‘   â€¢ Your IDE's warnings are trying to SAVE you                       â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘                      âš°ï¸  MEMORIAL WALL  âš°ï¸                           â–‘â–‘
 * â–‘â–‘              For those who tried and failed before you:              â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘                    â€¢ Junior Dev (2019-2019) RIP                      â–‘â–‘
 * â–‘â–‘                    â€¢ Senior Dev (2020-2020) RIP                      â–‘â–‘
 * â–‘â–‘                    â€¢ Tech Lead (2021-2022) Missing                   â–‘â–‘
 * â–‘â–‘                    â€¢ That One Intern (2023-2023) Therapy            â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘                         May God have mercy.                          â–‘â–‘
 * â–‘â–‘                         Godspeed, you magnificent fool.              â–‘â–‘
 * â–‘â–‘                         You're going to need it.                     â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘                    Last Modified: DO NOT MODIFY                      â–‘â–‘
 * â–‘â–‘                    Last Successful Edit: NEVER                       â–‘â–‘
 * â–‘â–‘                    Next Refactor: HEAT DEATH OF UNIVERSE             â–‘â–‘
 * â–‘â–‘                                                                       â–‘â–‘
 * â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */


#include "app.hpp"
#include <iostream>
#include <string>
#include <vector>

InferenceArgs parse_args(int argc, char* argv[]) {
    InferenceArgs args;

    for (int i = 1; i < argc; ++i) {
        std::string arg = argv[i];

        if (arg == "--model" && i + 1 < argc) {
            args.model_path = argv[++i];
        } else if (arg == "--prompt" && i + 1 < argc) {
            args.prompt = argv[++i];
        } else if (arg == "--max-tokens" && i + 1 < argc) {
            args.max_tokens = std::stoi(argv[++i]);
        } else if (arg == "--temperature" && i + 1 < argc) {
            args.temperature = std::stof(argv[++i]);
        } else if (arg == "--top-k" && i + 1 < argc) {
            args.top_k = std::stoi(argv[++i]);
        } else if (arg == "--top-p" && i + 1 < argc) {
            args.top_p = std::stof(argv[++i]);
        } else if (arg == "--seed" && i + 1 < argc) {
            args.seed = std::stoi(argv[++i]);
        } else if (arg == "--verbose") {
            args.verbose = true;
        } else if (arg == "--help") {
            App::print_usage(argv[0]);
            exit(0);
        } else {
            std::cerr << "Unknown argument: " << arg << std::endl;
            App::print_usage(argv[0]);
            exit(1);
        }
    }

    // Validate required arguments
    if (args.model_path.empty()) {
        std::cerr << "Error: --model is required" << std::endl;
        App::print_usage(argv[0]);
        exit(1);
    }

    if (args.prompt.empty()) {
        std::cerr << "Error: --prompt is required" << std::endl;
        App::print_usage(argv[0]);
        exit(1);
    }

    return args;
}

int main(int argc, char* argv[]) {
    InferenceArgs args = parse_args(argc, argv);

    std::cout << "Helios Engine - Mini LLM Inference" << std::endl;
    std::cout << "===================================" << std::endl;

    return App::run(args);
}
